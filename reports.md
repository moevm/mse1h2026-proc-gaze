# mse1h2026-proc-gaze
## О проекте
### Постановка задачи
Цель проекта — создать веб-приложение для задач прокторинга, которое помогает автоматически оценивать направление взгляда студента во время выполнения задания и выявлять признаки возможного списывания или жульничества (например, частые отводы взгляда от экрана, в сторону второго монитора или телефона).
Приложение упрощает проверку прокторинговых видеозаписей (запись с веб-камеры + скринкаст экрана) для преподавателя за счёт визуализации траектории взгляда и таймингов отводов взгляда.

Основная решаемая проблема: при дистанционном обучении и онлайн-тестировании преподавателю сложно вручную анализировать большое количество прокторинговых видеозаписей и объективно оценивать поведение студента. Студент может периодически смотреть в сторону второго монитора, телефона или других источников информации, но при ручном просмотре такие моменты сложно быстро и стабильно фиксировать. Преподавателю приходится просматривать видеозапись целиком, что занимает много времени и не всегда позволяет оперативно заметить подозрительные эпизоды.

### Требования
Клиентская часть:
- Режим калибровки для настройки соответствия положения глаз и координат экрана.
- Загрузка двух видеозаписей:
    - видео с веб-камеры;
    - скринкаст экрана.
- Просмотр результата:
    - видео/плеер со следом (курсором) предполагаемого взгляда;
    - таймлайн с отмеченными интервалами отводов взгляда.

Серверная часть
- POST /upload — приём пары видеозаписей и метаданных.
- Обработка видео:
    - применение модели/алгоритма оценки взгляда;
    - формирование траектории взгляда по времени.
- Сохранение результатов:
    - метаданные обработки;
    - координаты взгляда;
    - тайминги отклонений;
- GET /results?date=...&id=... — получение списка результатов:
    - всех результатов;
    - по дате;
    - по id студента;
    - по комбинации фильтров.

Стек технологий: FastAPI, Python+OpenCV, модели компьютерного зрения / gaze estimation, JavaScript, Vue, PostgreSQL, Docker. 

### Сценарии использования
- Сценарий "Загруженные видео(Главный экран)":

    <b>Действующее лицо: Пользователь \
    Предусловия: Пользователь находится на главном экране приложения. \
    Постусловия: Пользователь остался на главном экране либо перешел в сценарий <b>"Просмотр видео"</b>, список видео актуализирован (добавлено/удалено/изменено).</b>
    * Основной сценарий
    1. Приложение отображает список ранее загруженных видео (историю) и кнопку <i>загрузить видео</i>.
    2. <i>Если в списке есть видео: Система отображает для каждой записи сводную информацию.</i>
    3. Пользователь нажимает кнопку <i>загрузить видео</i> и переходит в сценарий <b>"Загрузка видео"</b>.
    * Альтернативный сценарий №1
    \
    <i> Включается на 2 шаге <u>основного сценария</u>, если пользователь ранее загружал видео.</i>
    1. Пользователь видит перед собой строку в истории загруженных видео, в которой приведена сводная информация о данном видео.
    2. Пользователь нажимает на кнопку <i>колокольчик</i>; приложение отправит уведомление при смене статуса обрабатываемого видео.
    3. Пользователь нажимает на кнопку <i>загрузить видео</i> и загружает ещё одно видео для обработки.
    4. Пользователь нажимает кнопку <i>стрелка</i> в строке истории загруженных видео и разворачивает дополнительную информацию о видео.
    5. Пользователь нажимает на кнопку <i>удалить</i> в строке с обработанным видео, остается в сценарии <b>"Загруженные видео"</b> и одна строка из истории загруженных видео удаляется.
    6. Пользователь нажимает на кнопку <i>просмотр</i> в строке с обработанным видео и переходит в сценарий <b>"Просмотр видео"</b>.
    * Альтернативный сценарий №2
    1. Пользователь закрывает приложение.
    2. Приложение сохраняет текущее состояние сессии.

- Сценарий "Загрузка видео":

    <b>Действующее лицо: Пользователь \
    Предусловия: Пользователь нажал кнопку <i>"Загрузить видео"</i> в сценарии "Загруженные видео". \
    Постусловия: Видео добавлено в очередь на обработку либо Пользователь отменил загрузку, Пользователь возвращен в сценарий "Загруженные видео". </b>
    * Основной сценарий
    1. Пользователь видит перед собой 3 кнопки: <i>загрузить видео с камеры</i>, <i>загрузить видео с экрана</i>, <i>загрузить</i>.
    2. Пользователь нажимает на кнопку <i>загрузить видео с камеры</i> и в открывшемся окне выбирает нужное видео.
    3. Пользователь нажимает на кнопку  <i>загрузить видео с экрана</i> и в открывшемся окне выбирает нужное видео.
    4. Пользователь нажимает на кнопку <i>загрузить</i> и переходит в сценарий <b>"Загруженные видео"</b>.
    * Альтернативный сценарий №1
    1. Пользователь нажимает на <i>крестик</i>.
    2. Приложение отменяет операцию.
    3. Пользователь возвращается в сценарий <b>"Загруженные видео"</b>.
    * Альтернативный сценарий №2
    1. Пользователь выбирает неправильный файл.
    2. Приложение сигнализирует об этом пользователю.

- Сценарий "Просмотр видео":

    <b>Действующее лицо: Пользователь \
    Предусловия: Видео имеет статус <i>"Готово"</i>, Пользователь нажал <i>"Просмотр"</i> в сценарии "Загруженные видео". \
    Постусловия: Пользователь просмотрел результат, скачал его или вернулся в список. </b>
    * Основной сценарий
    1. Пользователь видит перед собой кнопки: <i>вернуться на главную</i>, <i>скачать результат</i>, <i>список меток</i>; также он видит перед собой два синхронизированных плеера: предобработанное видео с камеры и предобработанное видео с экрана.
    2. Пользователь нажимает на кнопку <i>скачать результат</i> начинается загрузка обработанного видео.
    3. Пользователь нажимает на <i>временную метку в списке</i> и видео проматывается до заданной метки.
    4. Пользователь нажимает на кнопку плей на плеере и запускается синхронизированный просмотр видео.
    * Альтернативный сценарий
    1. Пользователь нажимает на кнопку <i>вернуться на главную</i>.
    2. Пользователь переходит в сценарий <b>"Загруженные видео"</b>.


### Инструкция по запуску

## Итерация №1
### Презентация
Ссылка на презентацию: [URL](https://github.com/moevm/mse1h2026-proc-gaze/blob/reports/docs/iteration1.pdf)

### Запланированные задачи
1. Организационная работа (получение доступа в репозиторий, корректная подпись имени в Github, установочная встреча с заказчиком);
2. Подготовка wiki-страницы с постановкой задачи, макетом UI, сценариями использования;
3. Инициализация клиента и сервера с используемыми технологиями, подготовка заготовки для будущего проекта;
4. Выбор библиотеки для трекинга взгляда;

### Выполненные задачи
1. Получен доступ в репозиторий (https://github.com/moevm/mse1h2026-proc-gaze), проект (https://github.com/orgs/moevm/projects/102), общий чат;
2. Указаны и проверены имена участников в Github;
3. Проведена установочная встреча с командой и заказчиком с записью и протоколами встречи; [протокол и запись](https://github.com/moevm/mse1h2026-proc-gaze/blob/reports/customer_sync.md)
4. Созданы issue на 1 итерацию, определен шаблон именования веток, указаны теги и описания задач;
5. Описана постановка задачи, включая цель проекта, описание требований, технологий, архитектуры и принципа работы приложения; [wiki](https://github.com/moevm/mse1h2026-proc-gaze/wiki)
6. В соответствии с поставленными требованиями создан макет UI; [wiki](https://github.com/moevm/mse1h2026-proc-gaze/wiki)
7. Описаны сценарии использования веб-приложения; [wiki](https://github.com/moevm/mse1h2026-proc-gaze/wiki)
8. Инициализирован клиент на JS+Vue, реализован интерфейс загрузки пар видео и их проигрывания;
9. Инициализирован сервер с использованием Python+FastAPI;
10. Описаны используемые Python-библиотеки и их версии для сервиса трекинга;
11. Проведено исследование существующих решений для трекинга взгляда по фото с веб-камеры и записи скринкаста; приведен пример работы с трекингом взгляда на основе OpenVINO; [Jupyter-notebook с примером](https://github.com/moevm/mse1h2026-proc-gaze/blob/main/tracking/research/main.ipynb)


### Задачи на следующую итерацию
1. Реализация главной страницы и страницы просмотра результата на клиенте;
1. Реализация REST-API на серверной части для взаимодействия с клиентом;
1. Реализация взаимодействия между сервисом backend-а и трекинга посредством брокера сообщений;
1. Реализация ERM-модели базы данных;
1. Реализация подключения к postgresql на серверной части и части трекинга;
1. Реализация предобработки входных видео на части трекинга;
1. Реализация трекинга взгляда на видео с экрана на части трекинга;
1. Обертка всех сервисов в Docker-контейнеры;


